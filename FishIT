local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local Window = Fluent:CreateWindow({
    Title = "Fishing FIX - Debugger",
    SubTitle = "Jika tidak mancing, coba ini",
    TabWidth = 140,
    Size = UDim2.fromOffset(500, 350),
    Theme = "Dark"
})

local Tabs = { Main = Window:AddTab({ Title = "Fix Fishing", Icon = "tool" }) }
local Options = Fluent.Options
local net = game:GetService("ReplicatedStorage").Packages["_Index"]["sleitnick_net@0.2.0"].net

-- Remote
local Remotes = {
    Charge = net["RF/ChargeFishingRod"],
    Request = net["RF/RequestFishingMinigameStarted"],
    Catch = net["RF/CatchFishCompleted"], 
    Cancel = net["RF/CancelFishingInputs"]
}

getgenv().fishingStart = false
local LocalPlayer = game:GetService("Players").LocalPlayer

-- LOGIKA BARU: Cek & Lempar
local function AttemptCast()
    -- Cara 1: Kirim Power 1.0
    Remotes.Charge:InvokeServer(1.0)
    
    -- Cara 2: Kirim tanpa argumen (Fallback)
    task.delay(0.1, function()
        Remotes.Charge:InvokeServer()
    end)
end

local function StartLoop()
    while getgenv().fishingStart do
        pcall(function()
            if not LocalPlayer.Character then return end
            
            local Tool = LocalPlayer.Character:FindFirstChildWhichIsA("Tool")
            if not Tool then
                Fluent:Notify({Title = "Error", Content = "PEGANG PANCINGAN DULU!", Duration = 2})
                task.wait(2)
                return
            end

            -- 1. LEMPAR (Dual Method)
            AttemptCast()
            
            -- Tunggu bobber muncul (Wajib ada delay minimal)
            task.wait(Options.DelayBait.Value) 
            
            if not getgenv().fishingStart then return end

            -- 2. TARIK (Bypass "!")
            -- Koordinat statis paling stabil
            Remotes.Request:InvokeServer(-1.115, 0, tick()) 
            
            -- 3. TANGKAP
            -- Delay Reel
            task.wait(Options.DelayReel.Value)
            Remotes.Catch:InvokeServer()
            
            -- 4. RESET
            task.wait(Options.DelayReset.Value)
            Remotes.Cancel:InvokeServer()
        end)
        task.wait(0.1)
    end
end

-- UI
Tabs.Main:AddToggle("ToggleFish", {Title = "Activate Fix Loop", Default = false }):OnChanged(function(v)
    getgenv().fishingStart = v
    if v then task.spawn(StartLoop) else pcall(function() Remotes.Cancel:InvokeServer() end) end
end)

Tabs.Main:AddSection("Pengaturan Delay (Aman)")

Tabs.Main:AddInput("DelayBait", {
    Title = "Delay Charge (Lempar)",
    Description = "Kalau tidak melempar, NAIKKAN angka ini",
    Default = "1.2", -- Default aman
    Numeric = true,
    Callback = function(v) end
})

Tabs.Main:AddInput("DelayReel", {
    Title = "Delay Reel (Tarik)",
    Default = "0.1", -- Semi-Instant
    Numeric = true,
    Callback = function(v) end
})

Tabs.Main:AddInput("DelayReset", {
    Title = "Delay Reset",
    Default = "0.5",
    Numeric = true,
    Callback = function(v) end
})

Tabs.Main:AddButton({
    Title = "Tes Manual: Lempar Sekali",
    Callback = function()
        AttemptCast()
        Fluent:Notify({Title = "Test", Content = "Mencoba melempar...", Duration = 1})
    end
})
