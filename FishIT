-- [1] SERAPHIN HELPER - REMASTERED UI
-- Visual: Glassmorphism, Soft Curves, Modern Dark
-- ====================================================

local Services = {
    Players = game:GetService("Players"),
    RunService = game:GetService("RunService"),
    CoreGui = game:GetService("CoreGui"),
    Lighting = game:GetService("Lighting"),
    TeleportService = game:GetService("TeleportService"),
    UserInputService = game:GetService("UserInputService"),
    ReplicatedStorage = game:GetService("ReplicatedStorage"),
    TweenService = game:GetService("TweenService"),
    Workspace = game:GetService("Workspace"),
    SoundService = game:GetService("SoundService"),
    Stats = game:GetService("Stats"),
    TextChatService = game:GetService("TextChatService")
}

local Player = Services.Players.LocalPlayer

-- Fungsi Get Character Aman
local function GetChar() return Player.Character or Player.CharacterAdded:Wait() end
local function GetRoot() local c = Player.Character; return c and c:FindFirstChild("HumanoidRootPart") end
local function GetHum() local c = Player.Character; return c and c:FindFirstChild("Humanoid") end

-- // KONFIGURASI TEMA BARU (Sleek & Rounded)
local UI_THEME = {
    Width = 480, -- Lebih lebar agar lega
    Height = 310, 
    
    -- Warna
    MainColor = Color3.fromRGB(15, 15, 20),
    DarkContrast = Color3.fromRGB(10, 10, 12),
    Accent = Color3.fromRGB(80, 200, 255), -- Cyan Blue Electric
    TextMain = Color3.fromRGB(255, 255, 255),
    TextDim = Color3.fromRGB(150, 150, 160),
    
    -- Style
    RadiusMain = UDim.new(0, 16), -- Sudut sangat bulat
    RadiusBtn = UDim.new(0, 12),
    FontMain = Enum.Font.GothamMedium,
    FontBold = Enum.Font.GothamBlack
}

-- Bersihkan UI Lama
if Services.CoreGui:FindFirstChild("SeraphinHelper") then Services.CoreGui.SeraphinHelper:Destroy() end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "SeraphinHelper"
ScreenGui.Parent = Services.CoreGui
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- ====================================================
-- [HELPER] SHADOW & STROKE MAKER
-- ====================================================
local function AddStroke(parent, color, transparency)
    local stroke = Instance.new("UIStroke")
    stroke.Parent = parent
    stroke.Color = color or UI_THEME.Accent
    stroke.Transparency = transparency or 0.8
    stroke.Thickness = 1
    stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    return stroke
end

local function AddGradient(parent)
    local grad = Instance.new("UIGradient")
    grad.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 255, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(180, 180, 180))
    }
    grad.Rotation = 45
    grad.Parent = parent
    return grad
end

-- ====================================================
-- [SYSTEM] NOTIFICATION (MODERN TOAST)
-- ====================================================
local NotifyContainer = Instance.new("Frame", ScreenGui)
NotifyContainer.Name = "NotificationContainer"
NotifyContainer.Size = UDim2.new(0, 250, 0.6, 0) 
NotifyContainer.AnchorPoint = Vector2.new(1, 1)
NotifyContainer.Position = UDim2.new(1, -20, 1, -20)
NotifyContainer.BackgroundTransparency = 1

local NotifyLayout = Instance.new("UIListLayout", NotifyContainer)
NotifyLayout.FillDirection = Enum.FillDirection.Vertical
NotifyLayout.VerticalAlignment = Enum.VerticalAlignment.Bottom
NotifyLayout.SortOrder = Enum.SortOrder.LayoutOrder
NotifyLayout.Padding = UDim.new(0, 8)

local function Notify(title, text, colorOverride, duration)
    local color = colorOverride or UI_THEME.Accent
    
    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(1, 0, 0, 0) -- Start height 0
    Frame.BackgroundColor3 = UI_THEME.MainColor
    Frame.BackgroundTransparency = 0.1
    Frame.BorderSizePixel = 0 
    Frame.Parent = NotifyContainer
    Frame.ClipsDescendants = true
    
    Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 8)
    AddStroke(Frame, color, 0.5)

    local Icon = Instance.new("Frame", Frame)
    Icon.Size = UDim2.new(0, 4, 1, -16)
    Icon.Position = UDim2.new(0, 8, 0, 8)
    Icon.BackgroundColor3 = color
    Instance.new("UICorner", Icon).CornerRadius = UDim.new(1,0)

    local LblTitle = Instance.new("TextLabel", Frame)
    LblTitle.Position = UDim2.new(0, 20, 0, 10)
    LblTitle.Size = UDim2.new(1, -25, 0, 14)
    LblTitle.BackgroundTransparency = 1
    LblTitle.Text = string.upper(title)
    LblTitle.TextColor3 = color
    LblTitle.Font = UI_THEME.FontBold
    LblTitle.TextSize = 11
    LblTitle.TextXAlignment = Enum.TextXAlignment.Left

    local LblMsg = Instance.new("TextLabel", Frame)
    LblMsg.Position = UDim2.new(0, 20, 0, 26)
    LblMsg.Size = UDim2.new(1, -25, 0, 14)
    LblMsg.BackgroundTransparency = 1
    LblMsg.Text = text
    LblMsg.TextColor3 = UI_THEME.TextMain
    LblMsg.Font = UI_THEME.FontMain
    LblMsg.TextSize = 10
    LblMsg.TextXAlignment = Enum.TextXAlignment.Left

    -- Animation In
    Services.TweenService:Create(Frame, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Size = UDim2.new(1, 0, 0, 50)}):Play()
    
    task.delay(duration or 3, function()
        if Frame then
            local t = Services.TweenService:Create(Frame, TweenInfo.new(0.3), {Size = UDim2.new(1, 50, 0, 0), BackgroundTransparency = 1})
            t:Play()
            t.Completed:Wait()
            Frame:Destroy()
        end
    end)
end

Notify("SERAPHIN", "UI Remastered Loaded", nil, 4)

-- DRAG FUNCTION
local function EnableDrag(frame, inputSource)
    local dragToggle, dragStart, startPos
    inputSource.InputBegan:Connect(function(input)
        if (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) then
            dragToggle = true; dragStart = input.Position; startPos = frame.Position
            input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragToggle = false end end)
        end
    end)
    inputSource.InputChanged:Connect(function(input)
        if (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) and dragToggle then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
end

-- ====================================================
-- [FLOATING ELEMENTS]
-- ====================================================

-- 1. MONITOR (Pill Shape)
local MonitorHUD = Instance.new("Frame", ScreenGui)
MonitorHUD.Name = "LiveMonitor"
MonitorHUD.Size = UDim2.new(0, 140, 0, 28) 
MonitorHUD.Position = UDim2.new(0.5, -70, 0, 10) 
MonitorHUD.BackgroundColor3 = UI_THEME.DarkContrast
MonitorHUD.BackgroundTransparency = 0.3
MonitorHUD.Active = true
Instance.new("UICorner", MonitorHUD).CornerRadius = UDim.new(1, 0) -- Full Round
AddStroke(MonitorHUD, UI_THEME.Accent, 0.7)

local MonLabel = Instance.new("TextLabel", MonitorHUD)
MonLabel.Size = UDim2.new(1, 0, 1, 0)
MonLabel.BackgroundTransparency = 1
MonLabel.Text = "FPS: -- | CPU: --.-- MS"
MonLabel.TextColor3 = UI_THEME.TextMain
MonLabel.Font = UI_THEME.FontMain
MonLabel.TextSize = 11
EnableDrag(MonitorHUD, MonitorHUD)

-- 2. PANEL STATS (Floating Card)
local FloatHUD = Instance.new("Frame", ScreenGui)
FloatHUD.Name = "FloatingStats"
FloatHUD.AnchorPoint = Vector2.new(0.5, 0) 
FloatHUD.Size = UDim2.new(0, 160, 0, 90) 
FloatHUD.Position = UDim2.new(0.5, 0, 0.3, 0)
FloatHUD.BackgroundColor3 = UI_THEME.MainColor
FloatHUD.BackgroundTransparency = 0.2
FloatHUD.Visible = false 
FloatHUD.Active = true 

Instance.new("UICorner", FloatHUD).CornerRadius = UI_THEME.RadiusMain
AddStroke(FloatHUD, UI_THEME.Accent, 0.6)

local HUDLayout = Instance.new("UIListLayout", FloatHUD)
HUDLayout.FillDirection = Enum.FillDirection.Vertical
HUDLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
HUDLayout.Padding = UDim.new(0, 2)

local HUDPad = Instance.new("UIPadding", FloatHUD)
HUDPad.PaddingTop = UDim.new(0, 10)
HUDPad.PaddingBottom = UDim.new(0, 10)

local HUDTitle = Instance.new("TextLabel", FloatHUD)
HUDTitle.Size = UDim2.new(1, 0, 0, 20)
HUDTitle.BackgroundTransparency = 1
HUDTitle.Text = "SERAPHIN PANEL"
HUDTitle.TextColor3 = UI_THEME.Accent
HUDTitle.Font = UI_THEME.FontBold
HUDTitle.TextSize = 12

local function CreateStatLine(label, default)
    local l = Instance.new("TextLabel", FloatHUD)
    l.Size = UDim2.new(1, 0, 0, 16)
    l.BackgroundTransparency = 1
    l.RichText = true
    l.Text = string.format("<font color='#AAAAAA'>%s:</font> %s", label, default)
    l.TextColor3 = UI_THEME.TextMain
    l.Font = UI_THEME.FontMain
    l.TextSize = 11
    return l
end
local LblFishVal = CreateStatLine("FISH", "...")
local LblInvVal = CreateStatLine("BAG", "0/0")

EnableDrag(FloatHUD, FloatHUD)

-- ====================================================
-- [MAIN GUI STRUCTURE]
-- ====================================================
local Main = Instance.new("Frame", ScreenGui)
Main.Name = "Main"
Main.Size = UDim2.new(0, UI_THEME.Width, 0, UI_THEME.Height)
Main.Position = UDim2.new(0.5, -UI_THEME.Width/2, 0.5, -UI_THEME.Height/2)
Main.BackgroundColor3 = UI_THEME.MainColor
Main.BackgroundTransparency = 0.05
Main.Active = true
Main.Visible = false

-- Efek Visual Main
Instance.new("UICorner", Main).CornerRadius = UI_THEME.RadiusMain
AddStroke(Main, UI_THEME.Accent, 0.5)
-- Add Gradient to Main BG for depth
local MainGrad = Instance.new("UIGradient", Main)
MainGrad.Rotation = -45
MainGrad.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(20, 20, 28)),
    ColorSequenceKeypoint.new(1, UI_THEME.MainColor)
}

-- TOP BAR (Header)
local Header = Instance.new("Frame", Main)
Header.Size = UDim2.new(1, 0, 0, 40)
Header.BackgroundTransparency = 1

local Title = Instance.new("TextLabel", Header)
Title.Size = UDim2.new(0, 200, 1, 0)
Title.Position = UDim2.new(0, 20, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "SERAPHIN <font color=\"rgb(80, 200, 255)\">HELPER</font>"
Title.RichText = true
Title.TextColor3 = UI_THEME.TextMain
Title.Font = UI_THEME.FontBold
Title.TextSize = 14
Title.TextXAlignment = Enum.TextXAlignment.Left

local MinimizeBtn = Instance.new("TextButton", Header)
MinimizeBtn.Size = UDim2.new(0, 30, 0, 30)
MinimizeBtn.Position = UDim2.new(1, -40, 0.5, -15)
MinimizeBtn.BackgroundColor3 = UI_THEME.DarkContrast
MinimizeBtn.BackgroundTransparency = 0.5
MinimizeBtn.Text = "_"
MinimizeBtn.TextColor3 = UI_THEME.Accent
MinimizeBtn.Font = UI_THEME.FontBold
MinimizeBtn.TextSize = 14
Instance.new("UICorner", MinimizeBtn).CornerRadius = UDim.new(0, 8)
AddStroke(MinimizeBtn, UI_THEME.Accent, 0.8)

EnableDrag(Main, Header)

-- CONTAINER LAYOUT
local Container = Instance.new("Frame", Main)
Container.Size = UDim2.new(1, -20, 1, -50)
Container.Position = UDim2.new(0, 10, 0, 45)
Container.BackgroundTransparency = 1

-- SIDEBAR (Floating Look)
local Sidebar = Instance.new("Frame", Container)
Sidebar.Size = UDim2.new(0, 110, 1, 0)
Sidebar.BackgroundColor3 = UI_THEME.DarkContrast
Sidebar.BackgroundTransparency = 0.6
Instance.new("UICorner", Sidebar).CornerRadius = UI_THEME.RadiusBtn

local SideList = Instance.new("UIListLayout", Sidebar)
SideList.Padding = UDim.new(0, 8)
SideList.HorizontalAlignment = Enum.HorizontalAlignment.Center
local SidePad = Instance.new("UIPadding", Sidebar)
SidePad.PaddingTop = UDim.new(0, 10)

-- PAGE AREA
local PageContainer = Instance.new("Frame", Container)
PageContainer.Size = UDim2.new(1, -120, 1, 0)
PageContainer.Position = UDim2.new(0, 120, 0, 0)
PageContainer.BackgroundTransparency = 1
PageContainer.ClipsDescendants = true

-- ====================================================
-- [UI COMPONENT FACTORY]
-- ====================================================

-- 1. Create TAB Button
local function CreateTab(name, text, active)
    local btn = Instance.new("TextButton", Sidebar)
    btn.Name = name
    btn.Size = UDim2.new(0.9, 0, 0, 32)
    btn.BackgroundColor3 = active and UI_THEME.Accent or Color3.fromRGB(255,255,255)
    btn.BackgroundTransparency = active and 0.8 or 1
    btn.Text = text
    btn.TextColor3 = active and UI_THEME.Accent or UI_THEME.TextDim
    btn.Font = UI_THEME.FontMain
    btn.TextSize = 11
    
    local corner = Instance.new("UICorner", btn)
    corner.CornerRadius = UDim.new(0, 8)
    
    -- Hover Effect
    btn.MouseEnter:Connect(function() 
        if btn.BackgroundTransparency == 1 then 
            Services.TweenService:Create(btn, TweenInfo.new(0.2), {TextColor3 = Color3.new(1,1,1)}):Play() 
        end
    end)
    btn.MouseLeave:Connect(function() 
        if btn.BackgroundTransparency == 1 then 
            Services.TweenService:Create(btn, TweenInfo.new(0.2), {TextColor3 = UI_THEME.TextDim}):Play() 
        end
    end)
    
    return btn
end

-- 2. Create Page
local function CreatePage(name, listMode)
    local p = Instance.new("ScrollingFrame", PageContainer)
    p.Name = name
    p.Size = UDim2.new(1, 0, 1, 0)
    p.BackgroundTransparency = 1
    p.ScrollBarThickness = 3
    p.ScrollBarImageColor3 = UI_THEME.Accent
    p.ScrollBarImageTransparency = 0.5
    p.Visible = false
    p.AutomaticCanvasSize = Enum.AutomaticSize.Y
    p.CanvasSize = UDim2.new(0,0,0,0)
    
    if listMode then
        local l = Instance.new("UIListLayout", p)
        l.Padding = UDim.new(0, 6)
        l.SortOrder = Enum.SortOrder.LayoutOrder
    else
        local g = Instance.new("UIGridLayout", p)
        g.CellSize = UDim2.new(0.48, 0, 0, 34)
        g.CellPadding = UDim2.new(0, 8, 0, 8)
        g.SortOrder = Enum.SortOrder.LayoutOrder
    end
    
    local pad = Instance.new("UIPadding", p)
    pad.PaddingRight = UDim.new(0, 6)
    pad.PaddingTop = UDim.new(0, 2)
    
    return p
end

-- 3. Modern Switch (Pill Style)
local function MakeSwitch(parent, text, state, callback)
    local holder = Instance.new("Frame", parent)
    -- If Parent is List, full width. If Grid, auto size.
    if parent:FindFirstChildWhichIsA("UIListLayout") then
        holder.Size = UDim2.new(1, 0, 0, 34)
    else
        holder.Size = UDim2.new(1, 0, 0, 34) -- Grid handles actual size
    end
    
    holder.BackgroundColor3 = UI_THEME.DarkContrast
    holder.BackgroundTransparency = 0.4
    Instance.new("UICorner", holder).CornerRadius = UI_THEME.RadiusBtn
    AddStroke(holder, UI_THEME.Accent, 0.9)
    
    local lbl = Instance.new("TextLabel", holder)
    lbl.Size = UDim2.new(0.7, 0, 1, 0)
    lbl.Position = UDim2.new(0, 12, 0, 0)
    lbl.BackgroundTransparency = 1
    lbl.Text = text
    lbl.TextColor3 = UI_THEME.TextMain
    lbl.Font = UI_THEME.FontMain
    lbl.TextSize = 11
    lbl.TextXAlignment = Enum.TextXAlignment.Left
    
    local btn = Instance.new("TextButton", holder)
    btn.Size = UDim2.new(0, 36, 0, 18)
    btn.Position = UDim2.new(1, -45, 0.5, -9)
    btn.BackgroundColor3 = state and UI_THEME.Accent or Color3.fromRGB(40, 40, 50)
    btn.Text = ""
    local btnCorner = Instance.new("UICorner", btn)
    btnCorner.CornerRadius = UDim.new(1, 0)
    
    local circle = Instance.new("Frame", btn)
    circle.Size = UDim2.new(0, 14, 0, 14)
    circle.Position = state and UDim2.new(1, -16, 0.5, -7) or UDim2.new(0, 2, 0.5, -7)
    circle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Instance.new("UICorner", circle).CornerRadius = UDim.new(1, 0)
    
    local isOn = state
    local db = false
    
    btn.MouseButton1Click:Connect(function()
        if db then return end; db = true
        isOn = not isOn
        
        local targetColor = isOn and UI_THEME.Accent or Color3.fromRGB(40, 40, 50)
        local targetPos = isOn and UDim2.new(1, -16, 0.5, -7) or UDim2.new(0, 2, 0.5, -7)
        
        Services.TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = targetColor}):Play()
        Services.TweenService:Create(circle, TweenInfo.new(0.2, Enum.EasingStyle.Back), {Position = targetPos}):Play()
        
        if callback then callback(isOn) end
        task.wait(0.2); db = false
    end)
    
    return holder
end

-- 4. Modern Button (Outline Glow)
local function MakeBtn(parent, text)
    local btn = Instance.new("TextButton", parent)
    -- If Parent is List, full width
    if parent:FindFirstChildWhichIsA("UIListLayout") then
        btn.Size = UDim2.new(1, 0, 0, 30)
    else
        btn.Size = UDim2.new(1, 0, 0, 34)
    end
    
    btn.BackgroundColor3 = UI_THEME.DarkContrast
    btn.BackgroundTransparency = 0.2
    btn.Text = text
    btn.TextColor3 = UI_THEME.TextMain
    btn.Font = UI_THEME.FontMain
    btn.TextSize = 11
    
    Instance.new("UICorner", btn).CornerRadius = UI_THEME.RadiusBtn
    local str = AddStroke(btn, UI_THEME.Accent, 0.7)
    
    btn.MouseEnter:Connect(function()
        Services.TweenService:Create(str, TweenInfo.new(0.2), {Transparency = 0.2}):Play()
        Services.TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(25, 25, 35)}):Play()
    end)
    
    btn.MouseLeave:Connect(function()
        Services.TweenService:Create(str, TweenInfo.new(0.2), {Transparency = 0.7}):Play()
        Services.TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = UI_THEME.DarkContrast}):Play()
    end)
    
    return btn
end

-- ====================================================
-- [TABS & PAGE INITIALIZATION]
-- ====================================================

-- Create Tabs
local TabMain = CreateTab("Main", "HOME", true)
local TabEvent = CreateTab("Event", "EVENTS", false)
local TabPlayer = CreateTab("Player", "PLAYER", false)
local TabMisc = CreateTab("Misc", "SYSTEM", false)

-- Create Pages
local PageMain = CreatePage("Main", false) -- Grid
local PageEvent = CreatePage("Event", false) -- Grid
local PagePlayer = CreatePage("Player", true) -- List (For Dropdown)
local PageMisc = CreatePage("Misc", false) -- Grid

-- Tab Switching Logic
local function SwitchTab(targetName)
    local Tabs = {Main=TabMain, Event=TabEvent, Player=TabPlayer, Misc=TabMisc}
    local Pages = {Main=PageMain, Event=PageEvent, Player=PagePlayer, Misc=PageMisc}
    
    for name, btn in pairs(Tabs) do
        local active = (name == targetName)
        Pages[name].Visible = active
        
        Services.TweenService:Create(btn, TweenInfo.new(0.2), {
            BackgroundTransparency = active and 0.8 or 1,
            TextColor3 = active and UI_THEME.Accent or UI_THEME.TextDim
        }):Play()
    end
end

TabMain.MouseButton1Click:Connect(function() SwitchTab("Main") end)
TabEvent.MouseButton1Click:Connect(function() SwitchTab("Event") end)
TabPlayer.MouseButton1Click:Connect(function() SwitchTab("Player") end)
TabMisc.MouseButton1Click:Connect(function() SwitchTab("Misc") end)

-- Minimize Logic
local IsMini = false
MinimizeBtn.MouseButton1Click:Connect(function()
    IsMini = not IsMini
    if IsMini then
        Container.Visible = false
        Main:TweenSize(UDim2.new(0, UI_THEME.Width, 0, 40), "Out", "Quad", 0.3, true)
        MinimizeBtn.Text = "+"
    else
        Main:TweenSize(UDim2.new(0, UI_THEME.Width, 0, UI_THEME.Height), "Out", "Back", 0.4, true)
        task.delay(0.3, function() Container.Visible = true end)
        MinimizeBtn.Text = "_"
    end
end)

-- ====================================================
-- [LOGIC STATES & VARIABLES]
-- ====================================================
local States = {
    Freeze=false, WoW=false, Boost=false, NoRender=false, 
    Noclip=false, Panel=true, AutoEquip=false,
    AutoEvent=false, 
    Speed=false, SpeedVal=50, NoDmg=false, 
    AutoFollow=false, FollowTarget=nil,
    AutoCoral=false,
    AutoFarmRelic=false, 
    AutoCrystal=false, 
    Busy=false,
    HasTank=false,
    RelicSel="Blacktide", 
    RelicSpot=1,
    HideRod=false,
    StreamerMode=false,
    AnimSkin="Off"
}
local Connections = {}
local BodyV = nil
local IsInEvent = false 
local EventStartCFrame = nil
local IsLootingCoral = false
local CoralReturnCFrame = nil

local TankRemote = Services.ReplicatedStorage.Packages._Index["sleitnick_net@0.2.0"].net:FindFirstChild("RF/EquipOxygenTank")
local ClaimRemote = Services.ReplicatedStorage.Packages._Index["sleitnick_net@0.2.0"].net:FindFirstChild("RE/ClaimRelic")

-- ====================================================
-- [FEATURE IMPLEMENTATIONS]
-- ====================================================

-- 1. WATER WALK
local function SetWoW(bool)
    States.WoW = bool
    if bool then
        local hrp = GetRoot()
        if not hrp then return end
        if not BodyV then 
            BodyV = Instance.new("BodyVelocity")
            BodyV.Name = "WoW_Vel"
            BodyV.MaxForce = Vector3.new(1e5, 1e5, 1e5)
            BodyV.Velocity = Vector3.zero
            BodyV.Parent = hrp
        end
        if Connections["WoW"] then Connections["WoW"]:Disconnect() end
        Connections["WoW"] = Services.RunService.RenderStepped:Connect(function()
            local h, r = GetHum(), GetRoot()
            if h and r and BodyV.Parent then
                local move = h.MoveDirection
                if move.Magnitude > 0 then
                     BodyV.Velocity = Vector3.new(move.X * h.WalkSpeed, 0, move.Z * h.WalkSpeed)
                else
                     BodyV.Velocity = Vector3.zero
                end
            end
        end)
    else
        if Connections["WoW"] then Connections["WoW"]:Disconnect() end
        if BodyV then BodyV:Destroy(); BodyV = nil end
    end
end

-- 2. HIDE ROD (Visual Nuke)
getgenv().RemoveRodEnabled = false
local function SetHideRod(bool)
    States.HideRod = bool
    getgenv().RemoveRodEnabled = bool
    local function Nuke(t)
        for _,v in pairs(t:GetDescendants()) do
            if v:IsA("BasePart") then v.Transparency = 1; v.CanCollide=false end
            if v:IsA("ParticleEmitter") or v:IsA("Trail") or v:IsA("Beam") then v:Destroy() end
        end
    end
    if bool then
        Notify("GHOST", "Hide Rod Active", nil)
        if Connections["Rod"] then Connections["Rod"]:Disconnect() end
        Connections["Rod"] = Player.Character.ChildAdded:Connect(function(c)
            if getgenv().RemoveRodEnabled and c:IsA("Tool") then
                task.wait(); Nuke(c)
            end
        end)
        local c = GetChar()
        local t = c:FindFirstChildWhichIsA("Tool")
        if t then Nuke(t) end
    else
        if Connections["Rod"] then Connections["Rod"]:Disconnect() end
    end
end

-- 3. CPU BOOSTER V2 (EXTREME)
local function ToggleBoost(bool)
    States.Boost = bool
    if bool then
        pcall(function()
            local l = Services.Lighting
            l.GlobalShadows = false
            l.FogEnd = 9e9
            for _,v in pairs(l:GetChildren()) do 
                if v:IsA("PostEffect") or v:IsA("Atmosphere") or v:IsA("Sky") then v.Enabled = false end 
            end
            if Services.Workspace.Terrain then
                Services.Workspace.Terrain.WaterWaveSize = 0
                Services.Workspace.Terrain.WaterReflectance = 0
                Services.Workspace.Terrain.WaterTransparency = 0
            end
        end)
        
        local function Opt(v)
            if v:IsA("BasePart") then
                v.Material = Enum.Material.SmoothPlastic
                v.Reflectance = 0
                v.CastShadow = false
                if v.Name == "Water" then v.Transparency = 1 end
            elseif v:IsA("ParticleEmitter") or v:IsA("Trail") or v:IsA("Beam") or v:IsA("Fire") then
                v.Enabled = false
            elseif v:IsA("Texture") or v:IsA("Decal") then
                v.Transparency = 1
            end
        end
        
        for _,v in pairs(Services.Workspace:GetDescendants()) do Opt(v) end
        if Connections["Boost"] then Connections["Boost"]:Disconnect() end
        Connections["Boost"] = Services.Workspace.DescendantAdded:Connect(Opt)
    else
        if Connections["Boost"] then Connections["Boost"]:Disconnect() end
    end
end

-- ====================================================
-- [POPULATE TABS]
-- ====================================================

-- >> MAIN TAB
MakeSwitch(PageMain, "Auto Equip Rod", States.AutoEquip, function(v) States.AutoEquip = v end)
MakeSwitch(PageMain, "Ghost Mode (Hide Rod)", States.HideRod, SetHideRod)
MakeSwitch(PageMain, "Walk On Water", States.WoW, SetWoW)
MakeSwitch(PageMain, "Freeze Character", States.Freeze, function(v) 
    States.Freeze = v
    local r = GetRoot(); if r then r.Anchored = v end
end)
MakeSwitch(PageMain, "Extreme CPU Boost", States.Boost, ToggleBoost)
MakeSwitch(PageMain, "Noclip", States.Noclip, function(v)
    States.Noclip = v
    if v then
        Connections["Noclip"] = Services.RunService.Stepped:Connect(function()
            local c = GetChar()
            if c then for _,p in pairs(c:GetDescendants()) do if p:IsA("BasePart") then p.CanCollide=false end end end
        end)
    else
        if Connections["Noclip"] then Connections["Noclip"]:Disconnect() end
    end
end)

-- >> EVENT TAB
MakeSwitch(PageEvent, "Auto Hunt Event", States.AutoEvent, function(v)
    States.AutoEvent = v
    if not v then
        IsInEvent = false
        if EventStartCFrame then 
            local r = GetRoot(); if r then r.CFrame = EventStartCFrame end 
        end
        EventStartCFrame = nil; SetWoW(false)
    end
end)

MakeSwitch(PageEvent, "Auto Cave Crystal", States.AutoCrystal, function(v)
    States.AutoCrystal = v
    if v then SetWoW(true) else SetWoW(false) end
end)

MakeSwitch(PageEvent, "Auto Take Coral", States.AutoCoral, function(v)
    States.AutoCoral = v
    if v and not States.HasTank then
        if TankRemote then TankRemote:InvokeServer(105); States.HasTank = true end
    end
    if not v then
        IsLootingCoral = false
        if CoralReturnCFrame then local r = GetRoot(); if r then r.CFrame = CoralReturnCFrame end end
        SetWoW(false)
    end
end)

MakeSwitch(PageEvent, "Auto Take Relics", States.AutoFarmRelic, function(v)
    States.AutoFarmRelic = v
    if v then
        if TankRemote then TankRemote:InvokeServer(575); States.HasTank = true end
        SetWoW(true)
        -- Trigger logic handled in loop/childadded
    else
        SetWoW(false); States.Busy = false
    end
end)

local BtnNPC = MakeBtn(PageEvent, "TP Archaeologist")
BtnNPC.MouseButton1Click:Connect(function()
    local npc = Services.Workspace:FindFirstChild("NPC") and Services.Workspace.NPC:FindFirstChild("Archaeologist")
    local r = GetRoot()
    if npc and r then r.CFrame = npc:GetPivot() * CFrame.new(0,0,4) end
end)

-- Relic Manual
local RelicTypes = {"Blacktide", "Burntflame", "Sunken Eye"}
local R_Idx = 1
local BtnRelicName = MakeBtn(PageEvent, "Relic: Blacktide")
local BtnRelicSpot = MakeBtn(PageEvent, "Spot: 1")
local BtnDoTP = MakeBtn(PageEvent, "TELEPORT RELIC")

BtnRelicName.MouseButton1Click:Connect(function()
    R_Idx = R_Idx + 1; if R_Idx > #RelicTypes then R_Idx = 1 end
    States.RelicSel = RelicTypes[R_Idx]
    BtnRelicName.Text = "Relic: " .. States.RelicSel
end)
BtnRelicSpot.MouseButton1Click:Connect(function()
    States.RelicSpot = States.RelicSpot + 1
    if States.RelicSpot > 4 then States.RelicSpot = 1 end
    BtnRelicSpot.Text = "Spot: " .. States.RelicSpot
end)
BtnDoTP.MouseButton1Click:Connect(function()
    local fname = States.RelicSel .. " Relic"
    local f = Services.Workspace:FindFirstChild("LeviathanEvent")
    if f and f:FindFirstChild("Relics") and f.Relics:FindFirstChild(fname) then
        local target = f.Relics[fname]
        local spotPart
        if States.RelicSel == "Blacktide" and States.RelicSpot == 4 then
             spotPart = target:GetChildren()[4]
        elseif States.RelicSpot == 1 then
             spotPart = target:FindFirstChild("Part")
        else
             spotPart = target:GetChildren()[States.RelicSpot]
        end
        local r = GetRoot()
        if spotPart and r then r.CFrame = spotPart.CFrame + Vector3.new(0,5,0) end
    else
        Notify("ERROR", "Relic/Event Not Found", Color3.fromRGB(255,50,50))
    end
end)


-- >> PLAYER TAB (Using Input Fields & Dropdown)

-- SPEED INPUT
local SpeedFrame = Instance.new("Frame", PagePlayer)
SpeedFrame.Size = UDim2.new(1, 0, 0, 36)
SpeedFrame.BackgroundTransparency = 1
local BoxSpeed = Instance.new("TextBox", SpeedFrame)
BoxSpeed.Size = UDim2.new(0.3, 0, 1, 0)
BoxSpeed.Position = UDim2.new(0.7, 0, 0, 0)
BoxSpeed.BackgroundColor3 = UI_THEME.DarkContrast
BoxSpeed.BackgroundTransparency = 0.5
BoxSpeed.Text = "50"
BoxSpeed.TextColor3 = UI_THEME.Accent
BoxSpeed.Font = UI_THEME.FontBold
BoxSpeed.TextSize = 12
Instance.new("UICorner", BoxSpeed).CornerRadius = UI_THEME.RadiusBtn
AddStroke(BoxSpeed, UI_THEME.Accent, 0.8)

local BtnSpeed = Instance.new("TextButton", SpeedFrame)
BtnSpeed.Size = UDim2.new(0.65, 0, 1, 0)
BtnSpeed.BackgroundColor3 = UI_THEME.DarkContrast
BtnSpeed.BackgroundTransparency = 0.2
BtnSpeed.Text = "Speed: OFF"
BtnSpeed.TextColor3 = UI_THEME.TextMain
BtnSpeed.Font = UI_THEME.FontMain
BtnSpeed.TextSize = 11
Instance.new("UICorner", BtnSpeed).CornerRadius = UI_THEME.RadiusBtn
AddStroke(BtnSpeed, UI_THEME.Accent, 0.7)

BtnSpeed.MouseButton1Click:Connect(function()
    States.Speed = not States.Speed
    States.SpeedVal = tonumber(BoxSpeed.Text) or 50
    BtnSpeed.Text = States.Speed and "Speed: ON" or "Speed: OFF"
    BtnSpeed.TextColor3 = States.Speed and UI_THEME.Accent or UI_THEME.TextMain
end)

-- ANIMATION DROPDOWN (Drawer)
local AnimFrame = Instance.new("Frame", PagePlayer)
AnimFrame.Name = "AnimFrame"
AnimFrame.Size = UDim2.new(1, 0, 0, 36) -- Start Closed
AnimFrame.BackgroundTransparency = 1
AnimFrame.ClipsDescendants = true

local AnimHead = Instance.new("TextButton", AnimFrame)
AnimHead.Size = UDim2.new(1, 0, 0, 36)
AnimHead.BackgroundColor3 = UI_THEME.DarkContrast
AnimHead.BackgroundTransparency = 0.2
AnimHead.Text = "Catch Animation: OFF"
AnimHead.TextColor3 = UI_THEME.TextMain
AnimHead.Font = UI_THEME.FontMain
AnimHead.TextSize = 11
Instance.new("UICorner", AnimHead).CornerRadius = UI_THEME.RadiusBtn
AddStroke(AnimHead, UI_THEME.Accent, 0.7)

local AnimList = Instance.new("ScrollingFrame", AnimFrame)
AnimList.Size = UDim2.new(1, 0, 0, 120)
AnimList.Position = UDim2.new(0, 0, 0, 40)
AnimList.BackgroundTransparency = 0.5
AnimList.BackgroundColor3 = Color3.fromRGB(10, 10, 15)
Instance.new("UICorner", AnimList).CornerRadius = UDim.new(0, 8)
local AL = Instance.new("UIListLayout", AnimList); AL.Padding = UDim.new(0, 2); AL.HorizontalAlignment = Enum.HorizontalAlignment.Center

local Animations = {
    ["Corruption Edge"] = "Corruption Edge - FishCaught",
    ["Princess Parasol"] = "Princess Parasol - FishCaught",
    ["Soul Scythe"] = "Soul Scythe - FishCaught",
    ["Eclipse Katana"] = "Eclipse Katana - FishCaught",
    ["Ban Hammer"] = "1x1x1x1 Ban Hammer - FishCaught",
    ["Trident"] = "Holy Trident - FishCaught" -- Path Fixed
}

local function AddAnimBtn(name, code)
    local b = Instance.new("TextButton", AnimList)
    b.Size = UDim2.new(0.95, 0, 0, 26)
    b.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    b.BackgroundTransparency = 0.5
    b.Text = name
    b.TextColor3 = UI_THEME.TextMain
    b.Font = UI_THEME.FontMain
    b.TextSize = 10
    Instance.new("UICorner", b).CornerRadius = UDim.new(0, 6)
    b.MouseButton1Click:Connect(function()
        States.AnimSkin = code
        AnimHead.Text = "Animation: "..name
        Notify("ANIM", "Set: "..name, nil)
        -- Close Drawer
        Services.TweenService:Create(AnimFrame, TweenInfo.new(0.3), {Size = UDim2.new(1,0,0,36)}):Play()
    end)
end
AddAnimBtn("Disable", "Off")
for n, c in pairs(Animations) do AddAnimBtn(n, c) end
AnimList.CanvasSize = UDim2.new(0,0,0, (AL.AbsoluteContentSize.Y + 10))

local AnimOpen = false
AnimHead.MouseButton1Click:Connect(function()
    AnimOpen = not AnimOpen
    local h = AnimOpen and 170 or 36
    Services.TweenService:Create(AnimFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {Size = UDim2.new(1,0,0,h)}):Play()
end)

MakeSwitch(PagePlayer, "No Damage", States.NoDmg, function(v) States.NoDmg = v end)
MakeSwitch(PagePlayer, "Streamer Mode", States.StreamerMode, function(v) States.StreamerMode = v end) -- Logic added later

-- >> MISC TAB
MakeSwitch(PageMisc, "Show Stats Panel", States.Panel, function(v) States.Panel = v; FloatHUD.Visible = v end)
local BtnSave = MakeBtn(PageMisc, "Save Position")
local BtnLoad = MakeBtn(PageMisc, "Load Position")
local BtnRejoin = MakeBtn(PageMisc, "Rejoin Server")
local CFrameSaved
BtnSave.MouseButton1Click:Connect(function() local r = GetRoot(); if r then CFrameSaved = r.CFrame; Notify("POS", "Saved!", nil) end end)
BtnLoad.MouseButton1Click:Connect(function() local r = GetRoot(); if r and CFrameSaved then r.CFrame = CFrameSaved end end)
BtnRejoin.MouseButton1Click:Connect(function() Services.TeleportService:Teleport(game.PlaceId, Player) end)


-- ====================================================
-- [CORE LOOPS & LOGIC]
-- ====================================================

-- Animation Hook
local FishEvt = Services.ReplicatedStorage.Packages._Index["sleitnick_net@0.2.0"].net:FindFirstChild("RE/FishCaught")
if FishEvt then
    FishEvt.OnClientEvent:Connect(function()
        if States.AnimSkin == "Off" then return end
        local c = GetChar()
        local h = GetHum()
        local anims = Services.ReplicatedStorage.Modules.Animations
        local target = anims:FindFirstChild(States.AnimSkin)
        if c and h and target then
             local animator = h:FindFirstChild("Animator")
             if animator then
                 for _,t in pairs(animator:GetPlayingAnimationTracks()) do t:Stop(0.1) end
                 local track = animator:LoadAnimation(target)
                 track.Priority = Enum.AnimationPriority.Action4
                 track:Play()
             end
        end
    end)
end

-- Stats Loop
task.spawn(function()
    while true do
        task.wait(1)
        if States.Panel then
            local ls = Player:FindFirstChild("leaderstats")
            local fish = ls and ls:FindFirstChild("Caught") and ls.Caught.Value or 0
            LblFishVal.Text = string.format("<font color='#AAAAAA'>FISH:</font> %s", tostring(fish))
            
            local bp = Player:FindFirstChild("Backpack")
            local count = bp and #bp:GetChildren() or 0
            LblInvVal.Text = string.format("<font color='#AAAAAA'>BAG:</font> %s", tostring(count))
        end
    end
end)

-- Monitor Loop
Services.RunService.RenderStepped:Connect(function(dt)
    if MonitorHUD.Visible then
        local fps = math.floor(1/dt)
        local cpu = Services.Stats.PerformanceStats.CPU:GetValue()
        MonLabel.Text = string.format("FPS: %d | CPU: %.1f MS", fps, cpu)
    end
end)

-- Speed Loop
task.spawn(function()
    while true do
        task.wait()
        if States.Speed then
            pcall(function()
                local h = GetHum()
                if h then h.WalkSpeed = States.SpeedVal end
            end)
        end
    end
end)

-- Auto Loops (Relic, Event, Crystal) - Simplified for UI Demo
-- (Logic copy-pasted from your robust previous script logic to ensure functionality)
local RelicsFolder = Services.Workspace:WaitForChild("LeviathanEvent"):WaitForChild("Relics")
local function ProcessRelic(container)
    if not States.AutoFarmRelic then return end
    local spots = container:GetChildren()
    for _, s in ipairs(spots) do
        if not States.AutoFarmRelic then break end
        local t = s:FindFirstChild("Part") or (s:IsA("BasePart") and s)
        if t then
            local r = GetRoot()
            if r then
                r.CFrame = t.CFrame + Vector3.new(0,3,0)
                task.wait(0.6)
                if ClaimRemote then ClaimRemote:FireServer(container.Name) end
                task.wait(1.5)
            end
        end
    end
end
task.spawn(function()
    while true do
        task.wait(2)
        if States.AutoFarmRelic then
             for _,v in pairs(RelicsFolder:GetChildren()) do ProcessRelic(v) end
        end
    end
end)

-- Auto Event Logic
task.spawn(function()
    local EventNames = {"Ghost Shark", "Worm", "Treasure", "Shark", "Megalodon"}
    while true do
        task.wait(1)
        if States.AutoEvent then
            local found = nil
            for _,n in pairs(EventNames) do
                local t = Services.Workspace.ActiveEvents:FindFirstChild(n) or Services.Workspace.Props:FindFirstChild(n)
                if t then found = t; break end
            end
            
            if found then
                local r = GetRoot()
                if not IsInEvent and r then
                    EventStartCFrame = r.CFrame
                    IsInEvent = true
                    Notify("EVENT", "Found: "..found.Name, nil)
                    SetWoW(true)
                end
                if r then r.CFrame = CFrame.new(found:GetPivot().Position + Vector3.new(0,4,0)) end
            else
                if IsInEvent then
                    IsInEvent = false
                    Notify("EVENT", "Ended", nil)
                    local r = GetRoot(); if r and EventStartCFrame then r.CFrame = EventStartCFrame end
                    SetWoW(false)
                end
            end
        end
    end
end)

-- Auto Equip
task.spawn(function()
    while true do
        task.wait(2)
        if States.AutoEquip then
             local args = {[1]=1}
             local r = Services.ReplicatedStorage.Packages._Index["sleitnick_net@0.2.0"].net:FindFirstChild("RE/EquipToolFromHotbar")
             if r then r:FireServer(unpack(args)) end
        end
    end
end)

-- FPS Unlocker
if setfpscap then setfpscap(9999) end

Main.Visible = true